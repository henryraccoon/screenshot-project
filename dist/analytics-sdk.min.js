var AnalyticsSDK=function(e){"use strict";var t=function(){function e(e){this.ws=null,this.eventQueue=[],this.consoleLogs=[],this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3,this.isConnected=!1,this.sessionId=e,this.initializeWebSocket(),this.setupEventListeners(),this.overrideConsoleMethods(),this.startPeriodicCollection()}return e.prototype.initializeWebSocket=function(){var e=this;this.ws=new WebSocket("wss://example.com/ws"),this.ws.onopen=function(){e.isConnected=!0,e.reconnectAttempts=0,e.flushQueue()},this.ws.onclose=function(){e.isConnected=!1,e.attemptReconnect()},this.ws.onerror=function(e){console.error("WebSocket error:",e)}},e.prototype.attemptReconnect=function(){var e=this;this.reconnectAttempts<this.maxReconnectAttempts&&(this.reconnectAttempts++,setTimeout((function(){e.initializeWebSocket()}),this.reconnectDelay*this.reconnectAttempts))},e.prototype.setupEventListeners=function(){var e=this;["click","scroll","input","change","mousemove","beforeunload"].forEach((function(t){document.addEventListener(t,(function(o){var n=o.target;if(n){var s={timestamp:Date.now(),type:t,target:{tag:n.tagName.toLowerCase(),id:n.id||"",classes:Array.from(n.classList),position:{x:n.getBoundingClientRect().x,y:n.getBoundingClientRect().y}}};e.eventQueue.push(s)}}),{capture:!0})}))},e.prototype.overrideConsoleMethods=function(){var e=this;["log","warn","error","info"].forEach((function(t){var o=console[t];console[t]=function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];e.consoleLogs.push("[".concat(t.toUpperCase(),"] ").concat(n.join(" "))),o.apply(console,n)}}))},e.prototype.collectAssetUrls=function(){var e=[];return document.querySelectorAll("img").forEach((function(t){var o=t.src;o&&e.push(o)})),document.querySelectorAll("video source").forEach((function(t){var o=t.src;o&&e.push(o)})),document.querySelectorAll("iframe").forEach((function(t){var o=t.src;o&&e.push(o)})),document.querySelectorAll("script").forEach((function(t){var o=t.src;o&&e.push(o)})),e},e.prototype.createPayload=function(){return{sessionId:this.sessionId,timestamp:Date.now(),events:this.eventQueue,domSnapshot:document.documentElement.outerHTML,consoleLogs:this.consoleLogs,pageUrl:window.location.href,assetUrls:this.collectAssetUrls()}},e.prototype.startPeriodicCollection=function(){var e=this;setInterval((function(){var t=e.createPayload(),o=LZString.compressToBase64(JSON.stringify(t));e.isConnected&&e.ws&&(e.ws.send(o),e.eventQueue=[],e.consoleLogs=[])}),5e3)},e.prototype.flushQueue=function(){if(this.eventQueue.length>0){var e=this.createPayload(),t=LZString.compressToBase64(JSON.stringify(e));this.ws&&this.isConnected&&(this.ws.send(t),this.eventQueue=[],this.consoleLogs=[])}},e}();return e.initAnalyticsClient=function(e){new t(e)},e}({});
