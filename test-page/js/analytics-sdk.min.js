var AnalyticsSDK=function(e){"use strict";class t{constructor(){this.ws=null,this.eventQueue=[],this.consoleLogs=[],this.sessionId=Date.now()+"-"+Math.random().toString(36).substring(2),this.connect(),this.setupEventListeners(),this.overrideConsoleMethods(),this.startPeriodicCollection()}connect(){this.ws&&(this.ws.close(),this.ws=null),this.ws=new WebSocket("ws://localhost:8080"),this.ws.onopen=()=>{this.sendQueuedData()},this.ws.onclose=()=>{setTimeout((()=>this.connect()),1e3)}}sendQueuedData(){if(0===this.eventQueue.length&&0===this.consoleLogs.length)return;const e={sessionId:this.sessionId,timestamp:Date.now(),events:this.eventQueue,domSnapshot:document.documentElement.outerHTML,consoleLogs:this.consoleLogs,pageUrl:window.location.href,assetUrls:this.collectAssetUrls()};if(this.ws?.readyState===WebSocket.OPEN)try{this.ws.send(LZString.compressToBase64(JSON.stringify(e))),this.eventQueue=[],this.consoleLogs=[]}catch(e){console.error("Failed to send data:",e)}}setupEventListeners(){["click","scroll","input","change","mousemove","beforeunload"].forEach((e=>{document.addEventListener(e,(t=>{const s=t.target;s&&this.eventQueue.push({timestamp:Date.now(),type:e,target:{tag:s.tagName.toLowerCase(),id:s.id||"",classes:Array.from(s.classList),position:{x:s.getBoundingClientRect().x,y:s.getBoundingClientRect().y}}})}),!0)}))}overrideConsoleMethods(){["log","warn","error","info"].forEach((e=>{const t=console[e];console[e]=(...s)=>{this.consoleLogs.push(`[${e.toUpperCase()}] ${s.join(" ")}`),t(...s)}}))}collectAssetUrls(){const e=[];return document.querySelectorAll("img, video source, iframe, script").forEach((t=>{const s=t.src;s&&e.push(s)})),e}startPeriodicCollection(){setInterval((()=>this.sendQueuedData()),5e3)}}const s=()=>{window._analyticsClient||(window._analyticsClient=new t)};return window.initAnalyticsClient=s,document.currentScript?.hasAttribute("data-auto-init")&&s(),e.AnalyticsClient=t,e}({});
